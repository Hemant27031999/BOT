{"ast":null,"code":"var _jsxFileName = \"/home/hemant/Desktop/broadband/src/Maps/MarkerMaps.js\",\n    _s = $RefreshSig$();\n\nimport { Circle, CircleMarker, MapContainer, Polyline, Polygon, Popup, Rectangle, TileLayer, Tooltip, UpdateMapCenter, useMap } from 'react-leaflet';\nimport new_orleans from './new_orleans.txt';\nimport phoenix from './phoenix.txt';\nimport React, { useState, Component } from 'react';\nimport Button from 'react-bootstrap/Button';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst center = [29.926734999999997, -90.085848];\nconst fillBlueOptions = {\n  fillColor: 'blue'\n};\nconst blackOptions = {\n  color: 'black'\n};\nconst limeOptions = {\n  color: 'lime'\n};\nconst purpleOptions = {\n  color: 'purple'\n};\nconst redOptions = {\n  color: 'red'\n};\nconst singleColor = '#00087a';\nconst doubleColor1 = '#7a0c00';\nconst doubleColor2 = '#014a44';\nconst MAX_COX = 100;\nconst MIN_COX = 0;\nconst CV_MAX = 13;\nconst CV_MIN = 0;\n\nfunction UpdateMapCentre(props) {\n  _s();\n\n  const map = useMap();\n  map.panTo(props.mapCentre);\n  return null;\n}\n\n_s(UpdateMapCentre, \"cX187cvZ2hODbkaiLn05gMk1sCM=\", false, function () {\n  return [useMap];\n});\n\n_c = UpdateMapCentre;\n\nfunction parseJSON(string) {\n  var array = JSON.parse(string);\n  return array;\n}\n\nfunction csvToArray(str) {\n  let delimiter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \";\";\n  const headers = str.slice(0, str.indexOf(\"\\n\")).split(delimiter);\n  const rows = str.slice(str.indexOf(\"\\n\") + 1).split(\"\\n\");\n  let isp_plans = {};\n  let cv_values = {};\n  var arr = [];\n\n  for (var i = 0; i < rows.length; i++) {\n    var row = rows[i];\n\n    if (row === '') {\n      continue;\n    }\n\n    const values = row.split(delimiter);\n    const el = headers.reduce(function (object, header, index) {\n      let colName = header.trim();\n\n      if (colName === \"Coordinates\" || colName === \"cv_cox_dict\" || colName === \"cv_att_dict\" || colName === \"cv_centurylink_dict\") {\n        object[colName] = parseJSON(values[index]);\n\n        if (colName !== \"Coordinates\") {\n          if (!(colName in isp_plans)) {\n            isp_plans[colName] = {};\n          }\n\n          for (const [key, value] of Object.entries(object[colName])) {\n            if (!(key in isp_plans[colName])) {\n              isp_plans[colName][key] = 0;\n            }\n\n            isp_plans[colName][key] += value;\n          }\n        }\n      } else if (colName === \"cv_att_avg\" || colName === \"cv_cox_avg\" || colName === \"cv_centurylink_avg\") {\n        object[colName] = parseFloat(values[index]);\n      } else {\n        object[colName] = values[index];\n      }\n\n      return object;\n    }, {});\n    arr.push(el);\n  }\n\n  return [isp_plans, arr];\n}\n\nconst readData = async value => {\n  var val = value.toLowerCase().replace(\" \", \"_\");\n  var res = '';\n  if (val === 'new_orleans') res = await fetch(new_orleans);else res = await fetch(phoenix);\n  res = await res.text();\n  var parsedData = csvToArray(res);\n  return parsedData;\n};\n\nfunction isEmpty(obj) {\n  return Object.keys(obj).length === 0;\n}\n\nfunction makePolygons(data, isp, compare) {\n  var poly = [];\n  let sz = data.length;\n\n  if (!compare) {\n    let range = CV_MAX - CV_MIN;\n\n    for (let i = 0; i < sz; i++) {\n      let opa = data[i]['cv_' + isp + '_avg'] / range;\n      poly.push( /*#__PURE__*/_jsxDEV(Polygon, {\n        pathOptions: {\n          color: '#ffffff',\n          opacity: opa,\n          fillColor: singleColor,\n          fillOpacity: opa\n        },\n        positions: data[i]['Coordinates'] // eventHandlers={{\n        //   mouseover: () => {console.log(i)}\n        // }}\n        ,\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          children: \"My Carriage value is: \" + data[i]['cv_' + isp + '_avg'].toFixed(2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 9\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this));\n    }\n  } else {\n    let range = CV_MAX - CV_MIN;\n    let second_isp = Object.keys(data[0])[3];\n    second_isp = second_isp.split(\"_\")[1];\n\n    for (let i = 0; i < sz; i++) {\n      let diff = data[i]['cv_cox_avg'] - data[i]['cv_' + second_isp + '_avg'];\n      let currentColor = '';\n      let currentRange = 0;\n      let opa = 0;\n\n      if (diff > 0) {\n        currentColor = doubleColor1;\n        opa = data[i]['cv_cox_avg'] / range;\n      } else {\n        currentColor = doubleColor2;\n        opa = data[i]['cv_' + second_isp + '_avg'] / range;\n      }\n\n      poly.push( /*#__PURE__*/_jsxDEV(Polygon, {\n        pathOptions: {\n          color: currentColor,\n          opacity: opa,\n          fillColor: currentColor,\n          fillOpacity: opa\n        },\n        positions: data[i]['Coordinates'] // eventHandlers={{\n        //   mouseover: () => {console.log(i)}\n        // }}\n        ,\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          children: \"COX Carriage value: \" + data[i]['cv_cox_avg'].toFixed(2) + \",\" + second_isp.toUpperCase() + \" Carriage value: \" + data[i]['cv_' + second_isp + '_avg'].toFixed(2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 9\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }, this));\n    }\n  }\n\n  return poly;\n}\n\nclass VectorLayersExample extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      res: [],\n      isp: this.props['isp'],\n      city: this.props['city'].toLowerCase().replace(\" \", \"_\")\n    };\n  }\n\n  async componentDidMount() {\n    var rr = await readData(this.state.city);\n    this.setState({\n      res: rr[1]\n    });\n    this.props.parentCallback(rr[0]);\n  }\n\n  async componentDidUpdate() {\n    var lowercase_city = this.props['city'].toLowerCase().replace(\" \", \"_\");\n\n    if (this.state.city !== lowercase_city) {\n      var rr = await readData(this.props.city);\n      this.props.parentCallback(rr[0]);\n      this.setState({\n        isp: this.props.isp,\n        city: lowercase_city,\n        res: rr[1]\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(MapContainer, {\n        center: this.props.center,\n        zoom: 13,\n        children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n          attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n          url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Circle, {\n          center: this.props.center,\n          pathOptions: fillBlueOptions,\n          radius: 200\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CircleMarker, {\n          center: center,\n          pathOptions: redOptions,\n          radius: 20,\n          \"data-tip\": \"hello world\",\n          children: /*#__PURE__*/_jsxDEV(Popup, {\n            children: \"Popup in CircleMarker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), makePolygons(this.state.res, this.props.isp, this.props.compareTwoISPs), /*#__PURE__*/_jsxDEV(UpdateMapCentre, {\n          mapCentre: this.props.center\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default VectorLayersExample;\n\nvar _c;\n\n$RefreshReg$(_c, \"UpdateMapCentre\");","map":{"version":3,"sources":["/home/hemant/Desktop/broadband/src/Maps/MarkerMaps.js"],"names":["Circle","CircleMarker","MapContainer","Polyline","Polygon","Popup","Rectangle","TileLayer","Tooltip","UpdateMapCenter","useMap","new_orleans","phoenix","React","useState","Component","Button","center","fillBlueOptions","fillColor","blackOptions","color","limeOptions","purpleOptions","redOptions","singleColor","doubleColor1","doubleColor2","MAX_COX","MIN_COX","CV_MAX","CV_MIN","UpdateMapCentre","props","map","panTo","mapCentre","parseJSON","string","array","JSON","parse","csvToArray","str","delimiter","headers","slice","indexOf","split","rows","isp_plans","cv_values","arr","i","length","row","values","el","reduce","object","header","index","colName","trim","key","value","Object","entries","parseFloat","push","readData","val","toLowerCase","replace","res","fetch","text","parsedData","isEmpty","obj","keys","makePolygons","data","isp","compare","poly","sz","range","opa","opacity","fillOpacity","toFixed","second_isp","diff","currentColor","currentRange","toUpperCase","VectorLayersExample","constructor","state","city","componentDidMount","rr","setState","parentCallback","componentDidUpdate","lowercase_city","render","compareTwoISPs"],"mappings":"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","sourcesContent":["import {\n  Circle,\n  CircleMarker,\n  MapContainer,\n  Polyline,\n  Polygon,\n  Popup,\n  Rectangle,\n  TileLayer,\n  Tooltip,\n  UpdateMapCenter,\n  useMap\n} from 'react-leaflet';\nimport new_orleans from './new_orleans.txt';\nimport phoenix from './phoenix.txt';\nimport React, { useState, Component } from 'react';\nimport Button from 'react-bootstrap/Button';\n\nconst center = [29.926734999999997, -90.085848];\n\nconst fillBlueOptions = { fillColor: 'blue' }\nconst blackOptions = { color: 'black' }\nconst limeOptions = { color: 'lime' }\nconst purpleOptions = { color: 'purple' }\nconst redOptions = { color: 'red' }\n\nconst singleColor = '#00087a'\nconst doubleColor1 = '#7a0c00'\nconst doubleColor2 = '#014a44'\n\nconst MAX_COX = 100\nconst MIN_COX = 0\n\nconst CV_MAX = 13\nconst CV_MIN = 0\n\n\nfunction UpdateMapCentre(props) {\n  const map = useMap();\n  map.panTo(props.mapCentre);\n  return null;\n} \n\n\nfunction parseJSON(string){\n  var array = JSON.parse(string);\n  return array\n}\n\n\nfunction csvToArray(str, delimiter = \";\") {\n  const headers = str.slice(0, str.indexOf(\"\\n\")).split(delimiter);\n  const rows = str.slice(str.indexOf(\"\\n\") + 1).split(\"\\n\");\n  let isp_plans = {}\n  let cv_values = {}\n  var arr = []\n  for(var i=0; i<rows.length; i++){\n    var row = rows[i]\n    if(row === ''){\n     continue;\n    }\n    const values = row.split(delimiter);\n    const el = headers.reduce(function (object, header, index) {\n      let colName = header.trim()\n      if(colName === \"Coordinates\" || colName === \"cv_cox_dict\" || colName === \"cv_att_dict\" || colName === \"cv_centurylink_dict\"){\n        object[colName] = parseJSON(values[index]);\n        if(colName !== \"Coordinates\"){\n          if(!(colName in isp_plans)){\n            isp_plans[colName] = {}\n          }\n          for (const [key, value] of Object.entries(object[colName])) {\n            if(!(key in isp_plans[colName])){\n              isp_plans[colName][key] = 0\n            }\n            isp_plans[colName][key] += value\n          }\n        }\n      }\n      else if(colName === \"cv_att_avg\" || colName === \"cv_cox_avg\" || colName === \"cv_centurylink_avg\"){\n        object[colName] = parseFloat(values[index]);\n      }\n      else{\n        object[colName] = values[index];\n      }\n\n      return object;\n    }, {});\n    arr.push(el)\n  }\n\n  return [isp_plans, arr];\n}\n\n\nconst readData = async(value) => {\n  var val = value.toLowerCase().replace(\" \", \"_\")\n  var res = ''\n  if(val === 'new_orleans') res = await fetch(new_orleans)\n  else res = await fetch(phoenix)\n\n  res = await res.text()\n  var parsedData = csvToArray(res)\n  return parsedData\n};\n\n\nfunction isEmpty(obj) {\n  return Object.keys(obj).length === 0;\n}\n\n\nfunction makePolygons(data, isp, compare){\n\n  var poly = []\n  let sz = data.length\n\n  if(!compare){\n    let range = CV_MAX - CV_MIN;\n\n    for(let i = 0; i < sz; i++){\n      let opa = data[i]['cv_' + isp + '_avg']/range\n      poly.push(\n        <Polygon \n          key={i}\n          pathOptions={{\n            color: '#ffffff',\n            opacity: opa,\n            fillColor: singleColor,\n            fillOpacity: opa\n          }}\n          positions={data[i]['Coordinates']}\n          // eventHandlers={{\n          //   mouseover: () => {console.log(i)}\n          // }}\n        >\n        <Tooltip>{\"My Carriage value is: \" + data[i]['cv_'+ isp +'_avg'].toFixed(2)}</Tooltip>\n        </Polygon>\n      )\n    }\n  }\n  else{\n    let range = CV_MAX - CV_MIN;\n    let second_isp = Object.keys(data[0])[3]\n    second_isp = second_isp.split(\"_\")[1]\n    for(let i = 0; i < sz; i++){\n      let diff = data[i]['cv_cox_avg'] - data[i]['cv_'+ second_isp +'_avg']\n      let currentColor = ''\n      let currentRange = 0\n      let opa = 0\n\n      if(diff>0){\n        currentColor = doubleColor1\n        opa = data[i]['cv_cox_avg']/range\n      }\n      else{\n        currentColor = doubleColor2\n        opa = data[i]['cv_'+ second_isp +'_avg']/range\n      }\n\n      poly.push(\n        <Polygon \n          key={i}\n          pathOptions={{\n            color: currentColor,\n            opacity: opa,\n            fillColor: currentColor,\n            fillOpacity: opa\n          }}\n          positions={data[i]['Coordinates']}\n          // eventHandlers={{\n          //   mouseover: () => {console.log(i)}\n          // }}\n        >\n        <Tooltip>{\"COX Carriage value: \" + data[i]['cv_cox_avg'].toFixed(2) + \",\" + second_isp.toUpperCase() + \" Carriage value: \" + data[i]['cv_'+ second_isp +'_avg'].toFixed(2)}</Tooltip>\n        </Polygon>\n      )\n    }\n  }\n\n  return poly\n}\n\n\nclass VectorLayersExample extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {\n      res: [],\n      isp: this.props['isp'],\n      city: this.props['city'].toLowerCase().replace(\" \", \"_\")\n    }\n  }\n\n  async componentDidMount() {\n    var rr = await readData(this.state.city)\n    this.setState({ res: rr[1]});\n    this.props.parentCallback(rr[0])\n  }\n\n  async componentDidUpdate(){\n    var lowercase_city = this.props['city'].toLowerCase().replace(\" \", \"_\")\n    if(this.state.city !== lowercase_city){\n      var rr = await readData(this.props.city)\n      this.props.parentCallback(rr[0])\n      this.setState({\n        isp: this.props.isp,\n        city: lowercase_city,\n        res: rr[1]\n      })\n    }\n  }\n\n  render(){\n\n    return (\n      <div>\n        <MapContainer center={this.props.center} zoom={13}>\n          <TileLayer\n            attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          />\n          <Circle center={this.props.center} pathOptions={fillBlueOptions} radius={200} />\n          <CircleMarker\n            center={center}\n            pathOptions={redOptions}\n            radius={20}\n            data-tip=\"hello world\"\n            >\n            <Popup>Popup in CircleMarker</Popup>\n          </CircleMarker>\n          {makePolygons(this.state.res, this.props.isp, this.props.compareTwoISPs)}\n          <UpdateMapCentre mapCentre={this.props.center} />\n        </MapContainer>\n      </div>\n    );\n  }\n}\n\nexport default VectorLayersExample;"]},"metadata":{},"sourceType":"module"}